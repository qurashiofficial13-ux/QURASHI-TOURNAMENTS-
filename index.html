<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>QURASHI Tournaments</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="QURASHI Tournaments ‚Äî Free Fire custom rooms, paid entry & prizes." />
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">
        <div class="logo">üèÜ</div>
        <div>QURASHI Tournaments</div>
      </div>
      <div class="tools">
        <a class="btn ghost" href="payment.html">Payment</a>
        <a class="btn ghost" href="login.html" id="loginTop">Login</a>
        <div class="menu">
          <button id="menuBtn" class="menu-btn">‚ãÆ</button>
          <div id="menuList" class="menu-list">
            <a href="index.html">Home</a>
            <a href="payment.html">Payment</a>
            <a href="login.html" data-login>Login</a>
            <button id="openAdmin" data-admin>Admin Panel</button>
            <button id="logoutBtn" data-logout class="hidden">Logout</button>
          </div>
        </div>
        <button class="btn brand" id="btnCreate" data-admin>Create Tournament</button>
      </div>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container hero-grid">
        <div>
          <h1>Host & Join <span style="color:var(--brand)">Free Fire</span> Tournaments</h1>
          <p>Entry fee + instant WhatsApp support. Cash prizes via JazzCash/EasyPaisa.</p>
          <div class="cta">
            <a href="#list" class="btn brand">Browse Tournaments</a>
            <a href="#fees" class="btn">Entry Fees</a>
            <a href="payment.html" class="btn">Payment</a>
          </div>
          <p class="note">Admin features (3 dots menu) sirf authorized email se login par dikhte hain.</p>
        </div>
        <div class="shot">
          <img alt="Gaming" src="https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=1600&auto=format&fit=crop">
        </div>
      </div>
    </section>

    <!-- Upcoming -->
    <section id="list">
      <div class="container">
        <div class="row" style="margin-bottom:12px;gap:12px;flex-wrap:wrap">
          <h2 style="margin:0">Upcoming Tournaments</h2>
          <div class="tools" style="margin-left:auto">
            <div class="search">
              <span>üîé</span>
              <input id="q" placeholder="Search name, mode, region..." />
            </div>
            <select id="mode">
              <option value="All">All</option>
              <option value="Solo">Solo</option>
              <option value="Duo">Duo</option>
              <option value="Squad">Squad</option>
            </select>
          </div>
        </div>
        <div id="grid" class="grid"></div>
        <p id="empty" class="muted" style="display:none;margin-top:10px">No tournaments found. Try another search.</p>
      </div>
    </section>

    <!-- Entry Fees -->
    <section id="fees">
      <div class="container">
        <h2>üéÆ Entry Fees & Prizes</h2>

        <div class="card" style="margin-bottom:12px">
          <div class="pad">
            <h3 style="margin:0 0 6px">Classic (C's) Mode</h3>
            <table>
              <thead><tr><th>Mode</th><th>Entry Fee</th><th>Winning Prize</th></tr></thead>
              <tbody>
                <tr><td>Solo</td><td>PKR 50</td><td>PKR 90</td></tr>
                <tr><td>Duo</td><td>PKR 50 / player</td><td>PKR 90 / player</td></tr>
                <tr><td>Squad</td><td>PKR 50 / player</td><td>PKR 90 / player</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <div class="pad">
            <h3 style="margin:0 0 6px">Battle Royale (BR) Mode</h3>
            <table>
              <thead><tr><th>Players</th><th>Entry Fee (per player)</th><th>Winning Prize</th></tr></thead>
              <tbody>
                <tr><td>20 players</td><td>PKR 20</td><td>PKR 350</td></tr>
                <tr><td>30 players</td><td>PKR 20</td><td>PKR 450</td></tr>
                <tr><td>48 players</td><td>PKR 20</td><td>PKR 600</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <p class="note" style="margin-top:10px">Payment details: see <a href="payment.html">Payment page</a>. WhatsApp support available.</p>
      </div>
    </section>

    <!-- Rules -->
    <section id="rules">
      <div class="container">
        <h2>Rules & Fair Play</h2>
        <ul class="rules">
          <li>Mobile-only by default; emulator events alag se marked.</li>
          <li>Ping/connection player ki responsibility; rehost only server fail par.</li>
          <li>Team/usernames clean & appropriate.</li>
          <li>Best-of-3 unless match page says otherwise.</li>
          <li>Disputes proof ke sath submit‚Äîadmins final call.</li>
          <li>Room ID/Pass start se 15 min pehle milta hai.</li>
        </ul>
      </div>
    </section>
  </main>

  <footer>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;padding:16px 0;">
      <div>¬© <span id="year"></span> QURASHI Tournaments</div>
      <button class="btn" id="reset" data-admin>Reset Local Data</button>
    </div>
  </footer>

  <!-- Register Modal -->
  <dialog id="regDialog">
    <form method="dialog" id="regForm">
      <div class="modal">
        <div class="row" style="margin-bottom:8px">
          <h3 style="margin:0">Register ‚Äî <span id="regTitle"></span></h3>
          <button class="btn" value="close" formnovalidate>‚úñ</button>
        </div>
        <div class="field">
          <label>Team / Player Name *</label>
          <input required id="fTeam" placeholder="e.g., Karachi Kings" />
        </div>
        <div class="row" style="gap:10px">
          <div class="field" style="flex:1">
            <label>Captain *</label>
            <input required id="fCaptain" placeholder="Your name" />
          </div>
          <div class="field" style="flex:1">
            <label>Phone (WhatsApp) *</label>
            <input required id="fPhone" placeholder="03xx-xxxxxxx" />
          </div>
        </div>
        <div class="field">
          <label>Email (optional)</label>
          <input id="fEmail" placeholder="you@email.com" />
        </div>
        <div class="field">
          <label>Free Fire Player IDs (comma separated)</label>
          <input id="fIds" placeholder="12345, 67890, ..." />
        </div>
        <div class="footer">
          <button class="btn" value="close" formnovalidate>Cancel</button>
          <button class="btn brand" id="submitReg" value="submit">Submit</button>
        </div>
        <p class="note">Note: data localStorage me safe hota hai (sirf isi device/browser).</p>
      </div>
    </form>
  </dialog>

  <!-- Create Tournament Modal -->
  <dialog id="createDialog">
    <form id="createForm" method="dialog">
      <div class="modal">
        <div class="row" style="margin-bottom:8px">
          <h3 style="margin:0">Create Tournament</h3>
          <button class="btn" value="close" formnovalidate>‚úñ</button>
        </div>
        <div class="field">
          <label>Title *</label>
          <input name="title" required placeholder="Weekend Squad Cup" />
        </div>
        <div class="row" style="gap:10px">
          <div class="field" style="flex:1">
            <label>Mode *</label>
            <select name="mode">
              <option>Solo</option><option>Duo</option><option>Squad</option>
            </select>
          </div>
          <div class="field" style="flex:1">
            <label>Prize Pool (PKR)</label>
            <input type="number" name="prize" value="3000" />
          </div>
        </div>
        <div class="row" style="gap:10px">
          <div class="field" style="flex:1">
            <label>Date *</label>
            <input type="date" name="date" required />
          </div>
          <div class="field" style="flex:1">
            <label>Time (PKT) *</label>
            <input type="time" name="time" required />
          </div>
        </div>
        <div class="row" style="gap:10px">
          <div class="field" style="flex:1">
            <label>Max Teams/Players *</label>
            <input type="number" name="max" value="32" required />
          </div>
          <div class="field" style="flex:1">
            <label>Region</label>
            <input name="region" placeholder="Pakistan, India, Global" />
          </div>
        </div>
        <div class="field">
          <label>Banner Image URL (optional)</label>
          <input name="banner" placeholder="https://..." />
        </div>
        <div class="footer">
          <button class="btn" value="close" formnovalidate>Cancel</button>
          <button class="btn brand" value="submit">Save</button>
        </div>
      </div>
    </form>
  </dialog>

  <!-- Admin Panel -->
  <dialog id="adminDialog">
    <form method="dialog" id="adminForm">
      <div class="modal">
        <div class="row" style="margin-bottom:8px">
          <h3 style="margin:0">Admin Panel</h3>
          <button class="btn" value="close" formnovalidate>‚úñ</button>
        </div>

        <div class="card" style="margin-bottom:10px">
          <div class="pad">
            <h4 style="margin:0 0 6px">Security</h4>
            <div class="row" style="gap:10px">
              <div class="field" style="flex:1">
                <label>Admin Email (fixed)</label>
                <input value="akkiller612@gmail.com" disabled />
              </div>
              <div class="field" style="flex:1">
                <label>Set/Change Admin Password</label>
                <input id="newPass" placeholder="new password" />
              </div>
            </div>
            <div class="footer">
              <button class="btn" id="savePassBtn">Save Password</button>
            </div>
            <p class="note">Static site: yeh password browser ke localStorage me store hota hai.</p>
          </div>
        </div>

        <div class="card">
          <div class="pad">
            <h4 style="margin:0 0 6px">Tournaments (edit JSON)</h4>
            <textarea id="tJSON" style="width:100%;height:180px;border:1px solid var(--line);border-radius:12px;padding:10px;font:inherit"></textarea>
            <div class="footer">
              <button class="btn" id="loadT">Load</button>
              <button class="btn brand" id="saveT">Save</button>
            </div>
            <p class="note">Save karne ke baad homepage turant refresh hoga.</p>
          </div>
        </div>
      </div>
    </form>
  </dialog>

  <!-- WhatsApp floating -->
  <a class="btn brand fab-wa" href="#" id="waFab">WhatsApp Support</a>

  <script src="app.js"></script>
  <script>
    // ---------- Demo data & state ----------
    const S_TOURNEYS = "qt.tournaments.v1";
    const S_REGS = "qt.registrations.v1";

    const seeds = [
      { id:"ff-001", title:"Solo Blitz Cup", mode:"Solo", date:"2025-09-10", time:"20:00",
        prizePool:5000, maxTeams:64, registered:28, platform:"Garena Free Fire (OB43)", region:"South Asia",
        banner:"https://images.unsplash.com/photo-1542751110-97427bbecf20?q=80&w=1600&auto=format&fit=crop" },
      { id:"ff-002", title:"Duo Rush Showdown", mode:"Duo", date:"2025-09-15", time:"21:00",
        prizePool:8000, maxTeams:48, registered:36, platform:"Garena Free Fire (OB43)", region:"Open ‚Äì Global",
        banner:"https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=1600&auto=format&fit=crop" },
      { id:"ff-003", title:"Squad Masters League", mode:"Squad", date:"2025-09-25", time:"19:30",
        prizePool:15000, maxTeams:32, registered:12, platform:"Garena Free Fire (OB43)", region:"Pakistan + India",
        banner:"https://images.unsplash.com/photo-1553481187-be93c21490a9?q=80&w=1600&auto=format&fit=crop" },
    ];

    const $ = sel => document.querySelector(sel);
    const grid = $("#grid");
    const empty = $("#empty");
    const q = $("#q");
    const mode = $("#mode");
    const year = $("#year");
    if(year) year.textContent = new Date().getFullYear();

    let tournaments = JSON.parse(localStorage.getItem(S_TOURNEYS) || "null") || seeds;
    let registrations = JSON.parse(localStorage.getItem(S_REGS) || "[]");

    function saveState(){
      localStorage.setItem(S_TOURNEYS, JSON.stringify(tournaments));
      localStorage.setItem(S_REGS, JSON.stringify(registrations));
    }

    function spotsLeft(t){ return t.maxTeams - t.registered; }
    function cardHTML(t){
      const left = spotsLeft(t);
      const leftCls = left>0 ? "ok" : "bad";
      const leftText = left>0 ? `${left} spots left` : "Full";
      return `
        <article class="card">
          <div class="banner"><img alt="${t.title}" src="${t.banner}"></div>
          <div class="pad">
            <div class="row" style="margin-bottom:4px">
              <h3 style="margin:0;font-size:18px">${t.title}</h3>
              <span class="chip">${t.mode}</span>
            </div>
            <div class="meta">
              <div>üìÖ ${t.date} ‚Ä¢ ${t.time}</div>
              <div>üèÜ PKR ${Number(t.prizePool||0).toLocaleString()}</div>
              <div>üë• ${t.registered}/${t.maxTeams}</div>
            </div>
            <div class="muted" style="margin-top:6px">${t.platform || "Free Fire"} ‚Ä¢ ${t.region || "Open"}</div>
            <div class="row" style="margin-top:10px">
              <span class="${leftCls}" style="font-weight:700;font-size:13px">${leftText}</span>
              <button class="btn brand" ${left<=0?"disabled":""} onclick="openRegister('${t.id}')">Register</button>
            </div>
          </div>
        </article>
      `;
    }

    function render(){
      const txt = (q?.value || "").trim().toLowerCase();
      const m = mode?.value || "All";
      const list = tournaments.filter(t=>{
        const inQ = !txt || t.title.toLowerCase().includes(txt) || t.mode.toLowerCase().includes(txt) || (t.region||"").toLowerCase().includes(txt);
        const inM = m === "All" || t.mode.toLowerCase().includes(m.toLowerCase());
        return inQ && inM;
      });
      grid.innerHTML = list.map(cardHTML).join("");
      if(empty) empty.style.display = list.length? "none":"block";
    }

    q?.addEventListener("input", render);
    mode?.addEventListener("change", render);

    // Register flow
    const regDialog = $("#regDialog");
    const regTitle = $("#regTitle");
    const fTeam = $("#fTeam");
    const fCaptain = $("#fCaptain");
    const fPhone = $("#fPhone");
    const fEmail = $("#fEmail");
    const fIds = $("#fIds");
    const submitReg = $("#submitReg");
    let regTournamentId = null;

    window.openRegister = function(id){
      const t = tournaments.find(x=>x.id===id);
      if(!t) return;
      regTournamentId = id;
      regTitle.textContent = t.title;
      if(fTeam) fTeam.value = "";
      if(fCaptain) fCaptain.value = "";
      if(fPhone) fPhone.value = "";
      if(fEmail) fEmail.value = "";
      if(fIds) fIds.value = "";
      regDialog.showModal();
    }

    submitReg?.addEventListener("click", (e)=>{
      if(!fTeam.value.trim() || !fCaptain.value.trim() || !fPhone.value.trim()){
        e.preventDefault(); alert("Please fill required fields."); return;
      }
      const tIndex = tournaments.findIndex(x=>x.id===regTournamentId);
      if(tIndex===-1){ alert("Tournament not found"); return; }
      const t = tournaments[tIndex];
      if(spotsLeft(t)<=0){ e.preventDefault(); alert("Tournament is full."); return; }
      registrations.push({
        tournamentId: regTournamentId,
        teamName: fTeam.value.trim(),
        captain: fCaptain.value.trim(),
        phone: fPhone.value.trim(),
        email: fEmail.value.trim(),
        playerIds: fIds.value.trim(),
        createdAt: new Date().toISOString()
      });
      tournaments[tIndex].registered = Math.min(t.maxTeams, t.registered + 1);
      saveState(); render();
      setTimeout(()=>alert("Registration received! We'll contact you on WhatsApp/Email."), 0);
    });

    // Create Tournament
    const btnCreate = $("#btnCreate");
    const createDialog = $("#createDialog");
    const createForm = $("#createForm");
    btnCreate?.addEventListener("click", ()=>createDialog.showModal());
    createForm?.addEventListener("submit", (e)=>{
      const fd = new FormData(createForm);
      const t = {
        id: crypto.randomUUID(),
        title: (fd.get("title")||"").toString(),
        mode: (fd.get("mode")||"Squad").toString(),
        date: (fd.get("date")||"").toString(),
        time: (fd.get("time")||"").toString(),
        prizePool: Number(fd.get("prize")||0),
        maxTeams: Number(fd.get("max")||0),
        registered: 0,
        platform: "Garena Free Fire",
        region: (fd.get("region")||"Open").toString(),
        banner: (fd.get("banner")||"https://images.unsplash.com/photo-1553481187-be93c21490a9?q=80&w=1600&auto=format&fit=crop").toString(),
      };
      tournaments = [t, ...tournaments];
      saveState(); render();
    });

    // Footer tools
    $("#reset")?.addEventListener("click", ()=>{
      if(confirm("Clear saved tournaments & registrations?")){
        localStorage.removeItem(S_TOURNEYS);
        localStorage.removeItem(S_REGS);
        tournaments = seeds.slice();
        registrations = [];
        render();
        alert("Local data cleared.");
      }
    });

    // WhatsApp floating
    const waFab = $("#waFab");
    if(waFab){ waFab.href = QT.waLink("Salam! Mujhe QURASHI Tournaments support chahiye."); }

    // Admin controls show/hide
    function applyAdminVisibility(){
      document.querySelectorAll("[data-admin]").forEach(el=>{
        el.classList.toggle("hidden", !QT.isAdmin());
      });
      document.querySelectorAll("[data-logout]").forEach(el=>{
        el.classList.toggle("hidden", !QT.getAuth());
      });
      const loginTop = document.querySelector("#loginTop");
      if(loginTop) loginTop.classList.toggle("hidden", !!QT.getAuth());
    }

    // Admin Panel
    const adminDialog = $("#adminDialog");
    $("#openAdmin")?.addEventListener("click", ()=>{
      if(!QT.isAdmin()){ alert("Admin only. Please login with authorized email."); return; }
      // preload tournaments JSON
      $("#tJSON").value = JSON.stringify(tournaments, null, 2);
      adminDialog.showModal();
    });
    $("#loadT")?.addEventListener("click", (e)=>{ e.preventDefault();
      $("#tJSON").value = JSON.stringify(JSON.parse(localStorage.getItem(S_TOURNEYS) || "[]"), null, 2);
    });
    $("#saveT")?.addEventListener("click", (e)=>{ e.preventDefault();
      try{
        tournaments = JSON.parse($("#tJSON").value);
        saveState(); render();
        alert("Saved!");
      }catch(err){ alert("Invalid JSON: " + err.message); }
    });
    $("#savePassBtn")?.addEventListener("click",(e)=>{ e.preventDefault();
      const p = $("#newPass").value.trim();
      if(!p) return alert("Enter new password.");
      QT.setAdminPass(p); $("#newPass").value="";
      alert("Admin password updated on this device.");
    });

    // init
    render();
    initMenu();
    applyAdminVisibility();
  </script>
</body>
              </html>    .search{display:flex;align-items:center;gap:8px;border:1px solid var(--line);padding:8px 10px;border-radius:12px;background:#fff;min-width:280px}
    .search input{border:none;outline:none;width:100%;font:inherit;background:transparent}
    select{border:1px solid var(--line);border-radius:12px;padding:8px 10px;background:#fff}
    /* grid */
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    @media (max-width:900px){.hero-grid{grid-template-columns:1fr}.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:580px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);overflow:hidden;box-shadow:0 6px 16px rgba(0,0,0,.04)}
    .card .banner{height:160px;overflow:hidden}
    .card .banner img{width:100%;height:100%;object-fit:cover;transition:transform .25s}
    .card:hover .banner img{transform:scale(1.05)}
    .card .pad{padding:14px}
    .meta{display:flex;flex-wrap:wrap;gap:10px;color:var(--muted);font-size:14px}
    .chip{background:#fff;border:1px solid var(--line);padding:4px 10px;border-radius:999px;font-size:12px;font-weight:700}
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .ok{color:var(--ok)} .bad{color:var(--bad)}
    /* sections */
    section{padding:26px 0}
    h2{font-size:22px;margin:0 0 12px}
    ul.rules{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    ul.rules li{background:#fff;border:1px solid var(--line);border-radius:12px;padding:10px;font-size:14px}
    @media (max-width:700px){ul.rules{grid-template-columns:1fr}}
    table{width:100%;border-collapse:collapse;background:#fff;border:1px solid var(--line);border-radius:12px;overflow:hidden}
    th,td{padding:10px 12px;border-bottom:1px solid var(--line);font-size:14px;text-align:left}
    th{background:#fafafa}
    /* dialog (modal) */
    dialog{border:none;border-radius:16px;padding:0;width:min(520px,92vw);box-shadow:0 20px 60px rgba(0,0,0,.2)}
    .modal{padding:16px}
    .field{display:grid;gap:6px;margin:8px 0}
    .field input,.field textarea{border:1px solid var(--line);border-radius:12px;padding:10px;font:inherit}
    .footer{display:flex;justify-content:flex-end;gap:10px;margin-top:8px}
    footer{border-top:1px solid var(--line);background:#fff;color:var(--muted)}
    .muted{color:var(--muted);font-size:14px}
    .note{font-size:13px;color:var(--muted)}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">
        <div class="logo">üèÜ</div>
        <div>Free Fire Tournaments</div>
      </div>
      <div class="tools">
        <button class="btn" id="btnCreate">Host Event</button>
      </div>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container hero-grid">
        <div>
          <h1>Host & Join <span style="color:var(--brand)">Free Fire</span> Tournaments ‚Äî 100% Free</h1>
          <p>Registration bilkul free. Squad banao, custom rooms, aur cash prizes jeeto.</p>
          <div class="cta">
            <a href="#list" class="btn brand">Browse Tournaments</a>
            <a href="#rules" class="btn">Read Rules</a>
          </div>
          <p class="note">Tip: niche ‚ÄúHost Event‚Äù se apna event add karo. Data localStorage me save hota hai.</p>
        </div>
        <div class="shot">
          <img alt="Gaming" src="https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=1600&auto=format&fit=crop">
        </div>
      </div>
    </section>

    <section id="list">
      <div class="container">
        <div class="row" style="margin-bottom:12px;gap:12px;flex-wrap:wrap">
          <h2 style="margin:0">Upcoming Tournaments</h2>
          <div class="tools" style="margin-left:auto">
            <div class="search">
              <span>üîé</span>
              <input id="q" placeholder="Search name, mode, region..." />
            </div>
            <select id="mode">
              <option value="All">All</option>
              <option value="Solo">Solo</option>
              <option value="Duo">Duo</option>
              <option value="Squad">Squad</option>
            </select>
          </div>
        </div>
        <div id="grid" class="grid"></div>
        <p id="empty" class="muted" style="display:none;margin-top:10px">No tournaments found. Try another search.</p>
      </div>
    </section>

    <section id="rules">
      <div class="container">
        <h2>Rules & Fair Play</h2>
        <ul class="rules">
          <li>Mobile-only by default; emulator events alag se marked.</li>
          <li>Ping/connection player ki responsibility; rehost only server fail par.</li>
          <li>Team/usernames clean & appropriate.</li>
          <li>Best-of-3 unless match page says otherwise.</li>
          <li>Disputes proof ke sath submit‚Äîadmins final call.</li>
          <li>Room ID/Pass start se 15 min pehle milta hai.</li>
        </ul>
      </div>
    </section>

    <section id="leaderboard">
      <div class="container">
        <h2>Leaderboard (Sample)</h2>
        <div style="overflow:auto;border-radius:12px">
          <table>
            <thead><tr><th>Rank</th><th>Team</th><th>Points</th><th>Wins</th></tr></thead>
            <tbody id="lb">
              <!-- filled by JS -->
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="faq">
      <div class="container">
        <h2>FAQ</h2>
        <details class="card"><summary class="pad" style="cursor:pointer;font-weight:700">Registration free hai?</summary><div class="pad muted">Haan, bilkul free. Koi entry fee nahi.</div></details>
        <details class="card" style="margin-top:10px"><summary class="pad" style="cursor:pointer;font-weight:700">Prize kaise milega?</summary><div class="pad muted">JazzCash/EasyPaisa/UPI/PayPal ‚Äî region ke hisaab se.</div></details>
        <details class="card" style="margin-top:10px"><summary class="pad" style="cursor:pointer;font-weight:700">Custom room details?</summary><div class="pad muted">Room ID/Password tournament start se 15 min pehle diye jayenge.</div></details>
      </div>
    </section>
  </main>

  <footer>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;padding:16px 0;">
      <div>¬© <span id="year"></span> Free Fire ‚Äî Community</div>
      <button class="btn" id="reset">Reset Local Data</button>
    </div>
  </footer>

  <!-- Register Modal -->
  <dialog id="regDialog">
    <form method="dialog" id="regForm">
      <div class="modal">
        <div class="row" style="margin-bottom:8px">
          <h3 style="margin:0">Register ‚Äî <span id="regTitle"></span></h3>
          <button class="btn" value="close" formnovalidate>‚úñ</button>
        </div>
        <div class="field">
          <label>Team / Player Name *</label>
          <input required id="fTeam" placeholder="e.g., Karachi Kings" />
        </div>
        <div class="row" style="gap:10px">
          <div class="field" style="flex:1">
            <label>Captain *</label>
            <input required id="fCaptain" placeholder="Your name" />
          </div>
          <div class="field" style="flex:1">
            <label>Phone (WhatsApp) *</label>
            <input required id="fPhone" placeholder="03xx-xxxxxxx" />
          </div>
        </div>
        <div class="field">
          <label>Email (optional)</label>
          <input id="fEmail" placeholder="you@email.com" />
        </div>
        <div class="field">
          <label>Free Fire Player IDs (comma separated)</label>
          <input id="fIds" placeholder="12345, 67890, ..." />
        </div>
        <div class="footer">
          <button class="btn" value="close" formnovalidate>Cancel</button>
          <button class="btn brand" id="submitReg" value="submit">Submit</button>
        </div>
        <p class="note">Note: data localStorage me safe hota hai (sirf isi device/browser).</p>
      </div>
    </form>
  </dialog>

  <!-- Create Tournament Modal -->
  <dialog id="createDialog">
    <form id="createForm" method="dialog">
      <div class="modal">
        <div class="row" style="margin-bottom:8px">
          <h3 style="margin:0">Create Tournament</h3>
          <button class="btn" value="close" formnovalidate>‚úñ</button>
        </div>
        <div class="field">
          <label>Title *</label>
          <input name="title" required placeholder="Weekend Squad Cup" />
        </div>
        <div class="row" style="gap:10px">
          <div class="field" style="flex:1">
            <label>Mode *</label>
            <select name="mode">
              <option>Solo</option>
              <option>Duo</option>
              <option>Squad</option>
            </select>
          </div>
          <div class="field" style="flex:1">
            <label>Prize Pool (PKR)</label>
            <input type="number" name="prize" value="3000" />
          </div>
        </div>
        <div class="row" style="gap:10px">
          <div class="field" style="flex:1">
            <label>Date *</label>
            <input type="date" name="date" required />
          </div>
          <div class="field" style="flex:1">
            <label>Time (PKT) *</label>
            <input type="time" name="time" required />
          </div>
        </div>
        <div class="row" style="gap:10px">
          <div class="field" style="flex:1">
            <label>Max Teams/Players *</label>
            <input type="number" name="max" value="32" required />
          </div>
          <div class="field" style="flex:1">
            <label>Region</label>
            <input name="region" placeholder="Pakistan, India, Global" />
          </div>
        </div>
        <div class="field">
          <label>Banner Image URL (optional)</label>
          <input name="banner" placeholder="https://..." />
        </div>
        <div class="footer">
          <button class="btn" value="close" formnovalidate>Cancel</button>
          <button class="btn brand" value="submit">Save</button>
        </div>
      </div>
    </form>
  </dialog>

  <script>
    // ---------- Storage helpers ----------
    const S_TOURNEYS = "ff.tournaments.v1";
    const S_REGS = "ff.registrations.v1";

    const seeds = [
      {
        id: "ff-001",
        title: "Solo Blitz Cup",
        mode: "Solo",
        date: "2025-09-10",
        time: "20:00",
        prizePool: 5000,
        maxTeams: 64,
        registered: 28,
        platform: "Garena Free Fire (OB43)",
        region: "South Asia",
        banner: "https://images.unsplash.com/photo-1542751110-97427bbecf20?q=80&w=1600&auto=format&fit=crop",
      },
      {
        id: "ff-002",
        title: "Duo Rush Showdown",
        mode: "Duo",
        date: "2025-09-15",
        time: "21:00",
        prizePool: 8000,
        maxTeams: 48,
        registered: 36,
        platform: "Garena Free Fire (OB43)",
        region: "Open ‚Äì Global",
        banner: "https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=1600&auto=format&fit=crop",
      },
      {
        id: "ff-003",
        title: "Squad Masters League",
        mode: "Squad",
        date: "2025-09-25",
        time: "19:30",
        prizePool: 15000,
        maxTeams: 32,
        registered: 12,
        platform: "Garena Free Fire (OB43)",
        region: "Pakistan + India",
        banner: "https://images.unsplash.com/photo-1553481187-be93c21490a9?q=80&w=1600&auto=format&fit=crop",
      },
    ];

    const $ = sel => document.querySelector(sel);
    const grid = $("#grid");
    const empty = $("#empty");
    const q = $("#q");
    const mode = $("#mode");
    const year = $("#year");
    year.textContent = new Date().getFullYear();

    // Leaderboard (sample)
    const lbData = [
      { team: "A1 Warriors", points: 78, wins: 3 },
      { team: "NoCap Duo", points: 64, wins: 2 },
      { team: "Karachi Kings", points: 59, wins: 1 },
      { team: "Delhi Demons", points: 48, wins: 1 },
      { team: "Lahore Legends", points: 41, wins: 0 },
    ];
    const lb = $("#lb");
    lb.innerHTML = lbData.map((r,i)=>`<tr><td>${i+1}</td><td>${r.team}</td><td>${r.points}</td><td>${r.wins}</td></tr>`).join("");

    // ---------- State ----------
    let tournaments = JSON.parse(localStorage.getItem(S_TOURNEYS) || "null") || seeds;
    let registrations = JSON.parse(localStorage.getItem(S_REGS) || "[]");

    function saveState(){
      localStorage.setItem(S_TOURNEYS, JSON.stringify(tournaments));
      localStorage.setItem(S_REGS, JSON.stringify(registrations));
    }

    // ---------- Rendering ----------
    function spotsLeft(t){ return t.maxTeams - t.registered; }

    function cardHTML(t){
      const left = spotsLeft(t);
      const leftCls = left>0 ? "ok" : "bad";
      const leftText = left>0 ? `${left} spots left` : "Full";
      return `
        <article class="card">
          <div class="banner"><img alt="${t.title}" src="${t.banner}"></div>
          <div class="pad">
            <div class="row" style="margin-bottom:4px">
              <h3 style="margin:0;font-size:18px">${t.title}</h3>
              <span class="chip">${t.mode}</span>
            </div>
            <div class="meta">
              <div>üìÖ ${t.date} ‚Ä¢ ${t.time}</div>
              <div>üèÜ PKR ${Number(t.prizePool||0).toLocaleString()}</div>
              <div>üë• ${t.registered}/${t.maxTeams}</div>
            </div>
            <div class="muted" style="margin-top:6px">${t.platform || "Free Fire"} ‚Ä¢ ${t.region || "Open"}</div>
            <div class="row" style="margin-top:10px">
              <span class="${leftCls}" style="font-weight:700;font-size:13px">${leftText}</span>
              <button class="btn brand" ${left<=0?"disabled":""} onclick="openRegister('${t.id}')">Register</button>
            </div>
          </div>
        </article>
      `;
    }

    function render(){
      const txt = (q.value || "").trim().toLowerCase();
      const m = mode.value;
      const list = tournaments.filter(t=>{
        const inQ = !txt || t.title.toLowerCase().includes(txt) || t.mode.toLowerCase().includes(txt) || (t.region||"").toLowerCase().includes(txt);
        const inM = m === "All" || t.mode.toLowerCase().includes(m.toLowerCase());
        return inQ && inM;
      });
      grid.innerHTML = list.map(cardHTML).join("");
      empty.style.display = list.length? "none":"block";
    }

    q.addEventListener("input", render);
    mode.addEventListener("change", render);

    // ---------- Register flow ----------
    const regDialog = document.getElementById("regDialog");
    const regTitle = document.getElementById("regTitle");
    const fTeam = document.getElementById("fTeam");
    const fCaptain = document.getElementById("fCaptain");
    const fPhone = document.getElementById("fPhone");
    const fEmail = document.getElementById("fEmail");
    const fIds = document.getElementById("fIds");
    const submitReg = document.getElementById("submitReg");
    let regTournamentId = null;

    window.openRegister = function(id){
      const t = tournaments.find(x=>x.id===id);
      if(!t) return;
      regTournamentId = id;
      regTitle.textContent = t.title;
      fTeam.value = fCaptain.value = fPhone.value = fEmail.value = fIds.value = "";
      regDialog.showModal();
    }

    submitReg.addEventListener("click", (e)=>{
      // prevent dialog default submit close if invalid
      if(!fTeam.value.trim() || !fCaptain.value.trim() || !fPhone.value.trim()){
        e.preventDefault();
        alert("Please fill required fields.");
        return;
      }
      const tIndex = tournaments.findIndex(x=>x.id===regTournamentId);
      if(tIndex===-1){ alert("Tournament not found"); return; }
      const t = tournaments[tIndex];
      if(spotsLeft(t)<=0){ e.preventDefault(); alert("Tournament is full."); return; }
      const payload = {
        tournamentId: regTournamentId,
        teamName: fTeam.value.trim(),
        captain: fCaptain.value.trim(),
        phone: fPhone.value.trim(),
        email: fEmail.value.trim(),
        playerIds: fIds.value.trim(),
        createdAt: new Date().toISOString()
      };
      registrations.push(payload);
      tournaments[tIndex].registered = Math.min(t.maxTeams, t.registered + 1);
      saveState();
      render();
      // allow dialog to close normally
      setTimeout(()=>alert("Registration received! We will contact you on WhatsApp/Email."), 0);
    });

    // ---------- Create Tournament ----------
    const btnCreate = document.getElementById("btnCreate");
    const createDialog = document.getElementById("createDialog");
    const createForm = document.getElementById("createForm");

    btnCreate.addEventListener("click", ()=>createDialog.showModal());

    createForm.addEventListener("submit", (e)=>{
      const fd = new FormData(createForm);
      const t = {
        id: crypto.randomUUID(),
        title: (fd.get("title")||"").toString(),
        mode: (fd.get("mode")||"Squad").toString(),
        date: (fd.get("date")||"").toString(),
        time: (fd.get("time")||"").toString(),
        prizePool: Number(fd.get("prize")||0),
        maxTeams: Number(fd.get("max")||0),
        registered: 0,
        platform: "Garena Free Fire",
        region: (fd.get("region")||"Open").toString(),
        banner: (fd.get("banner")||"https://images.unsplash.com/photo-1553481187-be93c21490a9?q=80&w=1600&auto=format&fit=crop").toString(),
      };
      tournaments = [t, ...tournaments];
      saveState();
      render();
      // let dialog close
    });

    // ---------- Footer tools ----------
    document.getElementById("reset").addEventListener("click", ()=>{
      if(confirm("Clear saved tournaments & registrations?")){
        localStorage.removeItem(S_TOURNEYS);
        localStorage.removeItem(S_REGS);
        tournaments = seeds.slice();
        registrations = [];
        render();
        alert("Local data cleared.");
      }
    });

    // ---------- First paint ----------
    render();
  </script>
</body>
</html>
